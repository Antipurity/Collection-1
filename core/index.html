<!doctype html>
<head>
  <meta charset=utf-8>
  <title>"War"</title>
</head>
<body>
  <noscript>JS required.</noscript>
  Experimental parse-eval-serialize loop, beneficial for early PL development.
  <div>
    CPU usage:
    <input id=timeUsed type=range min=0 max=100 step=1 value=20>
    <div id=timeUsedLabel></div>
  </div>
  <div>
    <textarea id=codeArea autofocus></textarea>
    <textarea id=resultArea readonly></textarea>
  </div>

  <link href="./codemirror/lib/codemirror.css" rel=stylesheet type="text/css"></link>
  <script src="./codemirror/lib/codemirror.js"></script>
  <script src="./codemirror/addon/mode/simple.js"></script>
  <script src="./codemirror/addon/edit/closebrackets.js"></script>
  <script src="./codemirror/addon/search/match-highlighter.js"></script>
  <script src="./codemirror/addon/selection/active-line.js"></script>
  <style>
    .cm-label { color: darkblue }
    .cm-lAx, .cm-rAx { color: darkslategray; font-size: 1.2em }
    .cm-matchhighlight {
      background-color: rgba(230, 30, 0, .3);
      box-shadow: coral 0 0 .3em;
      border-radius: .3em;
    }
    .CodeMirror-activeline { background-color: rgba(0, 100, 230, .2) }
  </style>
  <script>
    CodeMirror.defineSimpleMode('war', {
      start: [
        {regex:/[ \n\r\t]+/, token: 'ws'},
        {regex:/\(/, indent:true, token: 'lAx'},
        {regex:/\)/, dedent:true, token: 'rAx'},
        {regex:/'(?:[^']|'')*'/, token: 'string'},
        {regex:/[a-z.A-Z]+/, token: 'label'},
      ]
    })

    let basicHighlighting = {
      mode: 'war',
      lineWrapping: true,
      lineNumbers: true,
      firstLineNumber: 0,
      showCursorWhenSelecting: true,
      cursorBlinkRate: 0,
      cursorScrollMargin: 15,
      autoCloseBrackets: { pairs: "()''", explode: "()", },
      highlightSelectionMatches: true,
      styleActiveLine: true,
    }
    self.codeArea = CodeMirror.fromTextArea(codeArea, basicHighlighting)
    basicHighlighting.readOnly = true
    self.resultArea = CodeMirror.fromTextArea(resultArea, basicHighlighting)
    setInterval(() => codeArea.save(), 60000)
  </script>
  <script src="war.js"></script>
</body>
